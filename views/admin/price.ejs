<%- include('../_layouts/adminheader') %>
<div class="container">
  <br>
  <button class="btn btn-primary" id="submit" type="button">Submit</button>
    <table class="table table-striped table-bordered">
      <tr>
        <th colspan="2" class="thead-dark text-center">Morning</th>
      </tr>
     <tr>
        <th>Time</th>
        <th>Price</th>
      </tr>
      <% morningTimeArray.forEach(function(time) { %>
        <tr>
            <td><%=time.time%></td>
            <td><input id="morning" type="text" value="0"></td>
        </tr>
      <% }) %>
    </table>
    <br>
    <table class="table table-striped table-bordered">
      <tr>
        <th colspan="2" class="thead-dark text-center">Evening</th>
      </tr>
     <tr>
        <th>Time</th>
        <th>Price</th>
      </tr>
      <% eveningTimeArray.forEach(function(time) { %>
        <tr>
            <td><%=time.time%></td>
            <td><input id="evening" type="text" value="0"></td>
        </tr>
      <% }) %>
    </table>
    <br>
    <table>
      <table class="table table-striped table-bordered">
        <tr>
          <th colspan="2" class="thead-dark text-center">Night</th>
        </tr>
       <tr>
          <th>Time</th>
          <th>Price</th>
        </tr>
        <% nightTimeArray.forEach(function(time) { %>
          <tr>
              <td><%=time.time%></td>
              <td><input id="night" type="text" value="0"></td>
          </tr>
        <% }) %>
      </table>
    </table>
    <input id="getID" type="hidden" name="" value="<%=id%>">
</div>

<%- include('../_layouts/adminfooter') %>
<script type="text/javascript">
  $(function() {
    var morningPrices = [];
    var eveningPrices = [];
    var nightPrices = [];

    $('#submit').click(function() {
      var id = $('#getID').val();
      $("input[id*='morning']").each(function(i, price) {
        morningPrices.push($(this).val());
      })
      console.log(morningPrices);
      $("input[id*='evening']").each(function(i, price) {
        eveningPrices.push($(this).val());
      })
      console.log(eveningPrices);
      $("input[id*='night']").each(function(i, price) {
        nightPrices.push($(this).val());
      })
      console.log(nightPrices);

      $.ajax({
          type: 'POST',
          url: 'http://localhost:3000/admin/time/save-price',
          data: JSON.stringify({
            morningPrices: morningPrices,
            eveningPrices: eveningPrices,
            nightPrices: nightPrices,
            id: id
          }),
          success: function(response) {
              console.log('success');
              window.location.href = response.redirect;
          },
          contentType: 'application/json',
          error: function(jqXHR, textStatus, errorThrown){
              console.log(textStatus);
              console.log(jqXHR);
          }
      });
    });

 });
</script>
