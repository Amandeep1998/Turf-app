<% include _layouts/header %>
<div class="row">
  <div class="col-md-12">
    <br><br>
    <form action="/turf/book-now/<%=id%>" method="post">

      <table class="table table-striped table-dark">
        <tr>
          <th>Turf Details</th>
          <th>Date & Day</th>
          <th>Timings & Price</th>
          <th>Total Amount</th>
        </tr>
        <tr>
          <td>
            <ul style="list-style-type:none">
              <li><b><%= turf.turfName %></b></li>
              <li><%= turf.city %></li>
              <li><%=turf.area %></li>
              <li><%= turf.preferedFormat%></li>
            </ul>
          </td>
          <td><%=fullDate%></td>
          <td>
            <% var totalPrice = 0; %>
            <ul style="list-style-type:none;">
              <% finalTimingsAndPrices.forEach(function(item) { %>
                <% totalPrice += +item.price %>
                <li><button class="btn btn-info timings" type="button"><%=item.time%></button> - <b><%= item.price%></b> Rs</li>
                <% }) %>
              </ul>
            </td>
            <td><b><%=totalPrice%></b> Rs</td>
          </tr>
          <tr>
            <td><a class="btn btn-success" href="/turf/book/<%= turf._id %>">Change Timings</a></td>
            <td align="right" colspan="4"><button id="book-now" class="btn btn-warning" type="submit">Book Now</button></td>
          </tr>
        </table>

        <input type="hidden" id="final-timings" name="finalTimingsAndPrices" value="<%= JSON.stringify(finalTimingsAndPrices)%>">
        <input type="hidden" name="fullDate" value="<%=fullDate%>">
      </form>
    </div>
  </div>
<% include _layouts/footer %>
<script type="text/javascript">
  $(function() {
    var finalTimings = [];
    $('button#book-now').click(function() {
      finalTimings = JSON.parse($('input#final-timings').val());
      console.log(finalTimings);
    });
  })
</script>
